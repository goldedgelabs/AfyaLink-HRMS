name: Fix API imports

on:
  workflow_dispatch:

jobs:
  fix-imports:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Fix imports to apiFetch
        run: |
          find frontend/src -type f \( -name "*.js" -o -name "*.jsx" -o -name "*.ts" -o -name "*.tsx" \) -print0 |
          xargs -0 sed -i "s|from .*\(api\|pharmacyApi\)|from './utils/apiFetch'|g"

      - name: Commit changes
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "actions@github.com"
          git add frontend/src
          git commit -m "Fix imports to apiFetch" || echo "No changes to commit"
          git push
